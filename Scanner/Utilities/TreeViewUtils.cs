using Scanner.Model;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Scanner.Utilities
{
    public class TreeViewUtils
    {
        IList<IItemAdpater> _suspeciousItem;
        TreeView _treeViewTotalItems;

        public TreeViewUtils(IList<ISuspeciousItem> suspeciousItem, TreeView treeViewTotalItems)
        {
            _suspeciousItem = (IList < IItemAdpater > )suspeciousItem;
            _treeViewTotalItems = treeViewTotalItems;
        }

        public void Populate()
        {
            _treeViewTotalItems.BeginUpdate();

            // Clear the TreeView each time the method is called.
            _treeViewTotalItems.Nodes.Clear();

            TreeNode rootNode = _treeViewTotalItems.Nodes.Add("SuspeciousItemList");
            rootNode.Tag = _suspeciousItem;

            PopulateTreeView(_suspeciousItem, _treeViewTotalItems.Nodes[0].Nodes);

            // Reset the cursor to the default for all controls.
            Cursor.Current = Cursors.Default;

            // Begin repainting the TreeView.
            _treeViewTotalItems.EndUpdate();
        }

        private void PopulateTreeView(IList<IItemAdpater> suspeciousItems, TreeNodeCollection nodes)
        {
            if (suspeciousItems == null)
                return;
            int i = 0;
            foreach (var item in suspeciousItems)
            {
                TreeNode node = nodes.Add(item.ItemName);
                node.Tag = item;

                var suspeciousInnerItems = item.ChildItems;
                if (suspeciousInnerItems != null)
                {
                    PopulateTreeView(suspeciousInnerItems, nodes[i].Nodes);
                }
                i++;
            }
        }
    }
}
